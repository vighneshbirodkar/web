server netscape communications date tuesday jan gmt last modified thursday mar gmt content length content type text plain atomic transaction example like signing contract two parties sign effect ex fig ex withdraw account deposit account transaction model independent processes fail random communication reliable timeout retransmission stable storage types storage ram volatile power failure machine crashes ii disk survives cpu failures lost disk head crashes iii stable storage designed survive failures fig transaction primitive begin transaction start ii end transaction terminate commit iii abort transaction kill restore old value iv read v write fig properties transactions atomic indivisible outside ii consistent maintain system invariants iii isolated interference concurrent transactions iv durable committed changes permanent e g atomic append file consistent law conservation money isolated serializable fig c serial b serialized ok since values consistent c illegal nested transactions top level transaction fork children may execute one subtransactions subtransaction commit results visible parent transactions parent transaction aborted committed subtransaction must undone implementation undo intermediate updates private workspace give private workspace copy needed fig writeahead log w intentions list files actually modified place changes record written write log stable storage transaction file block old new values log files changed fig commit commit record written log abort changes undone rollback log also used recovering crashes two phase commit protocol commit transaction atomically difficult general paradox two generals want agree time attack even though messengers get impossibility proof assume exist shortest sequence msgs goal commit protocol sites agree either commit attack abort attack transaction relax req number msgs used commit protocol bounded fixed number msgs fig sish pp